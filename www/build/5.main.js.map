{"version":3,"sources":["../../src/pages/shopcart/shopcart.module.ts","../../src/pages/shopcart/shopcart.ts"],"names":[],"mappings":"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","file":"5.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ShopcartPage } from './shopcart';\n\n@NgModule({\n  declarations: [\n    ShopcartPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ShopcartPage),\n  ],\n  exports: [\n    ShopcartPage\n  ]\n})\nexport class ShopcartPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shopcart/shopcart.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ToastController, Content, Events } from 'ionic-angular';\n\nimport { NavigationService } from '../../providers/navigation-service/navigation-service';\nimport { ItemtypesService } from '../../providers/itemtypes-service/itemtypes-service';\nimport { UserstorageProvider } from '../../providers/userstorage/userstorage';\n\n\n\n@IonicPage()\n@Component({\n  selector: 'page-shopcart',\n  templateUrl: 'shopcart.html',\n})\nexport class ShopcartPage {\n\n\n  @ViewChild(Content) content: Content;\n  shopCart: Array<any>\n  shopCartNum: number = 0\n  totalPrice: number = 0\n\n  prices: Array<any>\n  priceSession\n  priceLoadComplete\n  priceNum = 10\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public navigationService: NavigationService,\n    public loadingCtrl: LoadingController,\n    public itemtypesService: ItemtypesService,\n    public userstorage: UserstorageProvider,\n    private toastCtrl: ToastController,\n    private event: Events,\n  ) {\n    // this.prices = this.navigationService.getPrices()\n    this.loadPrices()\n    \n  }\n\n  loadPrices() {\n    this.navigationService.loadPrices()\n    this.event.subscribe('prices', (data) => {\n      this.prices = data\n      this.priceSession = this.prices.slice(0,10)\n    })\n  }\n\n  loadPrcieSession(){\n    this.priceNum += 10\n    this.priceSession = this.prices.slice(0,this.priceNum)\n  }\n\n  doInfinite(infiniteScroll) {\n    setTimeout(() => {\n      this.loadPrcieSession()\n      infiniteScroll.complete();\n    }, 500);\n  }\n\n  ionViewDidEnter(){\n    this.scrollToTop()\n  }\n\n  ngDoCheck() {\n    this.getShopCart()\n    this.getShopCartNum()\n    this.getTotalPrice()\n  }\n\n  getShopCart() {\n    this.shopCart = this.navigationService.getShopCart()\n  }\n\n  getShopCartNum() {\n    this.shopCartNum = this.navigationService.getShopCartNum()\n  }\n\n  getTotalPrice() {\n    this.totalPrice = this.navigationService.getTotalPrice()\n    this.totalPrice = Math.round(this.totalPrice)\n  }\n\n  deleteProduct(x) {\n    this.navigationService.deleteProduct(x)\n  }\n\n  valueDefine(event, i) {\n    if (event.target.value > 99) {\n      this.shopCart[i].num = 100\n    }\n    if (event.target.value < 1) {\n      this.shopCart[i].num = 1\n    }\n  }\n\n  addToList() {\n    var user = this.userstorage.getUser()\n    if (!user) {\n      let toast = this.toastCtrl.create({\n        message: '请先登录',\n        duration: 1000\n      });\n      toast.present();\n      this.navCtrl.parent.select(2)\n    } else {\n      let loader = this.loadingCtrl.create({\n        content: \"添加至购物车...\",\n        duration: 500\n      });\n      loader.present();\n      console.log(user._id, this.shopCart, this.totalPrice)\n      this.addToShopList(user._id, this.shopCart, this.totalPrice)\n      this.clearProduct()\n    }\n  }\n\n  clearProduct() {\n    var temp = this;\n    setTimeout(function () {\n      temp.navigationService.clearProduct()\n    }, 1000);\n  }\n\n  addToShopList(userId, shoplist, totalprice) {\n    this.itemtypesService.addToShopList(userId, shoplist, totalprice).subscribe()\n  }\n\n  goParams(x) {\n    this.navCtrl.push('ParamsPage', { 'x': x });\n  }\n\n  scrollToTop() {\n        this.content.scrollToTop();\n  }\n  \n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/shopcart/shopcart.ts"],"sourceRoot":""}